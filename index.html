<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ูุฑุงุฌุนุฉ ุงููุฑุขู - Pro Edition</title>
    <meta name="description" content="ุชุทุจูู ุงุญุชุฑุงูู ูุญูุธ ููุฑุงุฌุนุฉ ุงููุฑุขู ุงููุฑูู">
    
    <!-- PWA -->
    <meta name="theme-color" content="#2d5016">
    <link rel="manifest" href="manifest.json">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    
    <!-- Base Styles -->
    <link rel="stylesheet" href="style.css">
<style>
        /* Additional custom styles */
        .hero-title {
            font-size: clamp(2.5rem, 8vw, 4rem);
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 1rem;
        }
        
        .hero-subtitle {
            font-size: 1.25rem;
            color: var(--color-text-secondary);
            max-width: 600px;
            margin: 0 auto 2rem;
        }
        
        .feature-icon-pro {
            width: 64px;
            height: 64px;
            border-radius: var(--radius-2xl);
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-gold) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: var(--space-4);
            box-shadow: 0 8px 20px rgba(45, 80, 22, 0.3);
        }
        
        .ayah-display {
            font-family: var(--font-arabic);
            font-size: 2rem;
            line-height: 2.5;
            text-align: center;
            padding: var(--space-8);
            background: linear-gradient(135deg, rgba(45, 80, 22, 0.05) 0%, rgba(212, 165, 116, 0.05) 100%);
            border-radius: var(--radius-3xl);
            border: 1px solid rgba(45, 80, 22, 0.1);
        }
        
        .memorization-item {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            padding: var(--space-4);
            background: var(--color-surface);
            border-radius: var(--radius-xl);
            margin-bottom: var(--space-3);
            transition: all var(--transition-base);
            border: 1px solid var(--color-border);
        }
        
        .memorization-item:hover {
            transform: translateX(-4px);
            box-shadow: var(--shadow-md);
            border-color: var(--color-primary);
        }
        
        .status-badge {
            width: 12px;
            height: 12px;
            border-radius: var(--radius-full);
            flex-shrink: 0;
        }
        
        .status-strong { background: var(--color-success); box-shadow: 0 0 10px rgba(16, 185, 129, 0.5); }
        .status-weak { background: var(--color-warning); box-shadow: 0 0 10px rgba(245, 158, 11, 0.5); }
        .status-new { background: var(--color-info); box-shadow: 0 0 10px rgba(59, 130, 246, 0.5); }
        
        /* Loading Screen */
        .loading-screen {
            position: fixed;
            inset: 0;
            background: var(--color-bg, #ffffff);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 99999;
        }
        
        .loading-screen.hidden {
            display: none !important;
        }
        
        .loading-logo {
            font-size: 4rem;
            margin-bottom: var(--space-4);
            animation: pulse 2s ease-in-out infinite;
        }
        
        .loading-bar {
            width: 200px;
            height: 4px;
            background: var(--color-gray-200);
            border-radius: var(--radius-full);
            overflow: hidden;
        }
        
        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, var(--color-primary), var(--color-gold));
            width: 0%;
            border-radius: var(--radius-full);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loading-screen">
        <div class="loading-logo">๐</div>
        <div class="loading-bar">
            <div class="loading-progress" id="loading-progress"></div>
        </div>
    </div>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="d-flex" style="justify-content: space-between;">
                <div class="d-flex" style="gap: var(--space-3);">
                    <h1 class="gradient-text" style="font-size: 1.5rem; font-weight: 700;">๐ ูุฑุงุฌุนุฉ ุงููุฑุขู</h1>
                    <span id="demo-badge" class="badge badge-warning hidden" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white;">๐ฎ MODE DรMO</span>
                </div>
                <nav class="d-flex" style="gap: var(--space-2);">
                    <a href="#" class="nav-link active" data-page="home">ุงูุฑุฆูุณูุฉ</a>
                    <a href="#" class="nav-link" data-page="memorization">ุงูุญูุธ</a>
                    <a href="#" class="nav-link" data-page="ward">ุงููุฑุฏ</a>
                    <a href="#" class="nav-link" data-page="progress">ุงูุชูุฏู</a>
                    <a href="#" class="nav-link" data-page="competition">๐</a>
                    <a href="#" class="nav-link" data-page="hifz">๐ญ</a>
                    <a href="#" class="nav-link nav-student-only" data-page="mytasks" style="display: none;">ููุงูู</a>
                    <a href="#" class="nav-link nav-teacher-only" data-page="teacher" style="display: none;">ุงููุนูู</a>
                    <a href="#" class="nav-link nav-admin-only" data-page="admin" style="display: none;">โ๏ธ ุงูุฅุฏุงุฑุฉ</a>
                    <button id="theme-toggle" class="btn btn-icon" style="margin-right: var(--space-4);">
                        <span id="theme-icon">๐</span>
                    </button>
                    <div id="auth-nav">
                        <button id="auth-login-btn" class="btn btn-primary btn-sm" onclick="showAuthModal()">
                            <span>๐ค</span>
                            ุฏุฎูู
                        </button>
                        <div id="auth-user-info" class="hidden d-flex" style="gap: var(--space-2);">
                            <span id="auth-username" class="badge badge-primary"></span>
                            <button class="btn btn-outline btn-sm" onclick="QuranReview.logout()">ุฎุฑูุฌ</button>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- HOME PAGE -->
        <div id="home-page" class="page active">
            <!-- Hero Section -->
            <section class="section" style="text-align: center; padding-top: var(--space-16);">
                <div class="container">
                    <h1 class="hero-title gradient-text animate-fade-up">
                        ุญูุธ ุงููุฑุขู<br>ุจุทุฑููุฉ ุนุตุฑูุฉ
                    </h1>
                    <p class="hero-subtitle animate-fade-up" style="animation-delay: 0.1s;">
                        ุชุทุจูู ุงุญุชุฑุงูู ูุฌูุน ุจูู ุงูุชูููุฉ ุงูุญุฏูุซุฉ ูุงูุทุฑููุฉ ุงููุจููุฉ ูู ุญูุธ ููุฑุงุฌุนุฉ ุงููุฑุขู ุงููุฑูู
                    </p>
                    <div class="d-flex" style="justify-content: center; gap: var(--space-4); animation-delay: 0.2s;" class="animate-fade-up">
                        <button class="btn btn-primary" onclick="navigateTo('memorization')">
                            <span>๐</span>
                            ุงุจุฏุฃ ุงูุญูุธ
                        </button>
                        <button class="btn btn-outline" onclick="navigateTo('ward')">
                            <span>๐ง</span>
                            ุงุณุชูุน ูููุฑุฏ
                        </button>
                    </div>
                </div>
            </section>

            <!-- Daily Motivation -->
            <section class="section">
                <div class="container">
                    <div class="glass-card shimmer" style="text-align: center; max-width: 800px; margin: 0 auto;">
                        <span class="badge badge-gold" style="margin-bottom: var(--space-4);">โจ ุญููุฉ ุงูููู</span>
                        <div class="arabic-large motivation-text" id="motivation-text" style="margin: var(--space-6) 0; font-size: 2rem;">
                            ุฎูููุฑููููู ูููู ุชูุนูููููู ุงููููุฑูุขูู ููุนูููููููู
                        </div>
                        <p class="motivation-source" id="motivation-source" style="color: var(--color-text-secondary);">ุฑูุงู ุงูุจุฎุงุฑู</p>
                    </div>
                </div>
            </section>

            <!-- Stats Section -->
            <section class="section">
                <div class="container">
                    <h2 class="section-title" style="text-align: center; margin-bottom: var(--space-8);">๐ ุฅุญุตุงุฆูุงุชู <span style="font-size: 0.875rem; color: var(--color-text-secondary); font-weight: 400;">ููู <span id="today-date"></span></span></h2>
                    <div class="grid grid-cols-4 stagger-children" id="home-stats">
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value stat-number" id="home-total-surahs">0</div>
                            <p style="color: var(--color-text-secondary); margin-top: var(--space-2);">ุฅุฌูุงูู ุงูุณูุฑ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value stat-number" id="home-mastered">0</div>
                            <p style="color: var(--color-text-secondary); margin-top: var(--space-2);">ูุชููุฉ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value stat-number" id="home-weak">0</div>
                            <p style="color: var(--color-text-secondary); margin-top: var(--space-2);">ุถุนููุฉ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value stat-number" id="home-new">0</div>
                            <p style="color: var(--color-text-secondary); margin-top: var(--space-2);">ุฌุฏูุฏุฉ</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Features Grid -->
            <section class="section">
                <div class="container">
                    <h2 class="section-title" style="text-align: center; margin-bottom: var(--space-8);">โจ ุงููููุฒุงุช</h2>
                    <div class="grid grid-cols-3 stagger-children">
                        <div class="glass-card hover-lift" style="text-align: center;">
                            <div class="feature-icon-pro">๐</div>
                            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: var(--space-2);">ูุฑุงุกุฉ ูุชูุงูุฉ</h3>
                            <p style="color: var(--color-text-secondary);">ุงุณุชูุงุน ูููุฑุงุกุงุช ุจุฃุตูุงุช ูุฎุชููุฉ ูุน ุนุฑุถ ุงููุตุญู</p>
                        </div>
                        <div class="glass-card hover-lift" style="text-align: center;">
                            <div class="feature-icon-pro">๐ง</div>
                            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: var(--space-2);">ุชุชุจุน ุฐูู</h3>
                            <p style="color: var(--color-text-secondary);">ูุธุงู ุชูุฑุงุฑ ูุชุจุงุนุฏ ูุถูุงู ุงูุญูุธ ุงูููู</p>
                        </div>
                        <div class="glass-card hover-lift" style="text-align: center;">
                            <div class="feature-icon-pro">๐ฏ</div>
                            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: var(--space-2);">ูุถุน ุงูุญูุธ</h3>
                            <p style="color: var(--color-text-secondary);">ุชูุงุฑูู ุชูุงุนููุฉ ูุงุฎุชุจุงุฑ ุงูุญูุธ ุจูุณุชููุงุช ูุฎุชููุฉ</p>
                        </div>
                        <div class="glass-card hover-lift" style="text-align: center;">
                            <div class="feature-icon-pro">๐</div>
                            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: var(--space-2);">ุชุญุฏูุงุช</h3>
                            <p style="color: var(--color-text-secondary);">ุชูุงูุณ ูุน ุงูุฃุตุฏูุงุก ูุงูุณุจ ุงูููุงุท</p>
                        </div>
                        <div class="glass-card hover-lift" style="text-align: center;">
                            <div class="feature-icon-pro">๐</div>
                            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: var(--space-2);">ุฅุญุตุงุฆูุงุช</h3>
                            <p style="color: var(--color-text-secondary);">ุชุชุจุน ุชูุฏูู ููููุงู ูุฃุณุจูุนูุงู ูุดูุฑูุงู</p>
                        </div>
                        <div class="glass-card hover-lift" style="text-align: center;">
                            <div class="feature-icon-pro">๐จโ๐ซ</div>
                            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: var(--space-2);">ูุนููู</h3>
                            <p style="color: var(--color-text-secondary);">ุชูุงุตู ูุน ูุนูููู ูุงุณุชูู ุงูููุงู</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- MEMORIZATION PAGE -->
        <div id="memorization-page" class="page">
            <section class="section">
                <div class="container">
                    <div class="d-flex" style="justify-content: space-between; align-items: center; margin-bottom: var(--space-8); flex-wrap: wrap; gap: var(--space-4);">
                        <h2 class="section-title" style="margin: 0;">๐ ูุงุฆูุฉ ุงูุญูุธ</h2>
                        <button class="btn btn-primary" onclick="QuranReview.showAddMemorization()">
                            <span>โ</span>
                            ุฅุถุงูุฉ ุญูุธ ุฌุฏูุฏ
                        </button>
                    </div>
                    
                    <!-- Add Form -->
                    <div class="glass-card" id="add-memorization-form-container" style="margin-bottom: var(--space-6); display: none;">
                        <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: var(--space-6);">โ ุฅุถุงูุฉ ุญูุธ ุฌุฏูุฏ</h3>
                        <form id="add-memorization-form" onsubmit="QuranReview.handleAddMemorization(event)">
                            <div class="form-floating" style="margin-bottom: var(--space-4);">
                                <select id="surah-select" required>
                                    <option value="">-- ุงุฎุชุฑ ุงูุณูุฑุฉ --</option>
                                    <option value="1">1. ุงููุงุชุญุฉ (7 ุขูุงุช)</option>
                                    <option value="2">2. ุงูุจูุฑุฉ (286 ุขูุฉ)</option>
                                    <option value="3">3. ุขู ุนูุฑุงู (200 ุขูุฉ)</option>
                                    <option value="4">4. ุงููุณุงุก (176 ุขูุฉ)</option>
                                    <option value="5">5. ุงููุงุฆุฏุฉ (120 ุขูุฉ)</option>
                                    <option value="6">6. ุงูุฃูุนุงู (165 ุขูุฉ)</option>
                                    <option value="7">7. ุงูุฃุนุฑุงู (206 ุขูุงุช)</option>
                                    <option value="8">8. ุงูุฃููุงู (75 ุขูุฉ)</option>
                                    <option value="9">9. ุงูุชูุจุฉ (129 ุขูุฉ)</option>
                                    <option value="10">10. ูููุณ (109 ุขูุงุช)</option>
                                </select>
                                <label for="surah-select">ุงูุณูุฑุฉ</label>
                            </div>
                            
                            <div class="grid grid-cols-2" style="margin-bottom: var(--space-4);">
                                <div class="form-floating">
                                    <input type="number" id="from-ayah" min="1" placeholder=" " required>
                                    <label for="from-ayah">ูู ุงูุขูุฉ</label>
                                </div>
                                <div class="form-floating">
                                    <input type="number" id="to-ayah" min="1" placeholder=" " required>
                                    <label for="to-ayah">ุฅูู ุงูุขูุฉ</label>
                                </div>
                            </div>
                            
                            <div class="d-flex" style="justify-content: flex-end; gap: var(--space-3);">
                                <button type="button" class="btn btn-outline" onclick="QuranReview.hideAddMemorization()">ุฅูุบุงุก</button>
                                <button type="submit" class="btn btn-primary">ุฅุถุงูุฉ</button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Table -->
                    <div class="glass-card">
                        <div class="d-flex" style="justify-content: space-between; align-items: center; margin-bottom: var(--space-6);">
                            <h3 style="font-size: 1.125rem; font-weight: 600;">๐ ุฌุฏูู ุงูุญูุธ</h3>
                            <span class="badge badge-glass" id="memorization-count">0 ุณูุฑ</span>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="memorization-table" id="memorization-table">
                                <thead>
                                    <tr>
                                        <th>ุงูุณูุฑุฉ</th>
                                        <th>ุงูุขูุงุช</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุขุฎุฑ ูุฑุงุฌุนุฉ</th>
                                        <th>ุงูุชุงูู</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="memorization-table-body">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div id="memorization-empty" style="text-align: center; padding: var(--space-10);">
                            <div style="font-size: 4rem; margin-bottom: var(--space-4);">๐</div>
                            <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: var(--space-2);">ูุง ุชูุฌุฏ ุณูุฑ ูุญููุธุฉ</h3>
                            <p style="color: var(--color-text-secondary); margin-bottom: var(--space-4);">ุงุจุฏุฃ ุฑุญูุฉ ุงูุญูุธ ุจุฅุถุงูุฉ ุณูุฑุฉ ุฌุฏูุฏุฉ</p>
                            <button class="btn btn-primary" onclick="QuranReview.showAddMemorization()">
                                <span>โ</span>
                                ุฅุถุงูุฉ ุณูุฑุฉ
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- WARD PAGE -->
        <div id="ward-page" class="page">
            <section class="section">
                <div class="container" style="max-width: 800px;">
                    <h2 class="section-title" style="text-align: center; margin-bottom: var(--space-8);">๐ง ุงููุฑุฏ ุงููููู</h2>
                    
                    <div class="glass-card" style="margin-bottom: var(--space-6);">
                        <div class="form-floating" style="margin-bottom: var(--space-4);">
                            <select id="ward-surah-select" class="select-modern">
                                <option value="">ุงุฎุชุฑ ุงูุณูุฑุฉ</option>
                                <option value="1">ุณูุฑุฉ ุงููุงุชุญุฉ</option>
                                <option value="2">ุณูุฑุฉ ุงูุจูุฑุฉ</option>
                                <option value="3">ุณูุฑุฉ ุขู ุนูุฑุงู</option>
                            </select>
                            <label for="ward-surah-select">ุงูุณูุฑุฉ</label>
                        </div>
                        
                        <div class="grid grid-cols-2" style="margin-bottom: var(--space-6);">
                            <div class="form-floating">
                                <input type="number" id="ward-from-ayah" placeholder=" " min="1" value="1">
                                <label for="ward-from-ayah">ูู ุงูุขูุฉ</label>
                            </div>
                            <div class="form-floating">
                                <input type="number" id="ward-to-ayah" placeholder=" " min="1" value="7">
                                <label for="ward-to-ayah">ุฅูู ุงูุขูุฉ</label>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2" style="margin-bottom: var(--space-4);">
                            <div class="form-floating">
                                <select id="ward-reciter-selector">
                                    <option value="alafasy">ูุดุงุฑู ุจู ุฑุงุดุฏ ุงูุนูุงุณู</option>
                                </select>
                                <label for="ward-reciter-selector">ุงููุงุฑุฆ</label>
                            </div>
                            <div class="form-floating">
                                <select id="ward-audio-quality">
                                    <option value="192">ุนุงููุฉ (192 kbps)</option>
                                    <option value="128" selected>ูุชูุณุทุฉ (128 kbps)</option>
                                    <option value="64">ููุฎูุถุฉ (64 kbps)</option>
                                </select>
                                <label for="ward-audio-quality">ุฌูุฏุฉ ุงูุตูุช</label>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2" style="margin-bottom: var(--space-4);">
                            <div class="form-floating">
                                <select id="ward-audio-source">
                                    <option value="cdn" selected>ุงูุฎุงุฏู ุงููุจุงุดุฑ</option>
                                    <option value="api">API</option>
                                </select>
                                <label for="ward-audio-source">ูุตุฏุฑ ุงูุตูุช</label>
                            </div>
                            <div class="form-floating">
                                <select id="ward-image-quality">
                                    <option value="high" selected>ุนุงููุฉ</option>
                                    <option value="medium">ูุชูุณุทุฉ</option>
                                    <option value="low">ููุฎูุถุฉ</option>
                                </select>
                                <label for="ward-image-quality">ุฌูุฏุฉ ุงูุตูุฑุฉ</label>
                            </div>
                        </div>
                        
                        <div class="form-floating" style="margin-bottom: var(--space-4);">
                            <select id="ward-ayah-delay">
                                <option value="0" selected>ุจุฏูู ุชุฃุฎูุฑ</option>
                                <option value="0.5">0.5 ุซุงููุฉ</option>
                                <option value="1">1 ุซุงููุฉ</option>
                                <option value="2">2 ุซูุงู</option>
                                <option value="3">3 ุซูุงู</option>
                                <option value="5">5 ุซูุงู</option>
                            </select>
                            <label for="ward-ayah-delay">ุชุฃุฎูุฑ ุจูู ุงูุขูุงุช</label>
                        </div>
                        
                        <div style="margin-bottom: var(--space-4);">
                            <label class="toggle-switch">
                                <input type="checkbox" id="ward-autoplay-next" checked>
                                <span class="toggle-slider"></span>
                                <span style="margin-right: var(--space-3);">ุงูุชุดุบูู ุงูุชููุงุฆู ููุขูุฉ ุงูุชุงููุฉ</span>
                            </label>
                        </div>
                        
                        <button class="btn btn-primary btn-full" onclick="playWard()">
                            <span>โถ๏ธ</span>
                            ุชุดุบูู ุงููุฑุฏ
                        </button>
                    </div>
                    
                    <!-- Audio Player -->
                    <div class="player-glass" id="ward-player">
                        <div style="text-align: center; margin-bottom: var(--space-4);">
                            <span class="badge badge-glass" id="ward-progress-text">ุงูุขูุฉ 1 ูู 7</span>
                        </div>
                        
                        <div class="ward-ayah-image" id="ward-image-container" style="min-height: 200px; display: flex; align-items: center; justify-content: center; background: rgba(45, 80, 22, 0.05); border-radius: var(--radius-2xl); margin-bottom: var(--space-4);">
                            <img id="ward-image" src="" alt="Ayah Image" style="display: none; max-width: 100%; border-radius: var(--radius-xl);">
                            <div id="ward-ayah-text" class="arabic-large" style="text-align: center; padding: var(--space-6); font-size: 1.75rem;">
                                ุจูุณููู ุงูููููู ุงูุฑููุญููููฐูู ุงูุฑููุญูููู
                            </div>
                        </div>
                        
                        <div class="progress-glass" style="margin: var(--space-6) 0;">
                            <div class="fill" id="ward-progress-bar" style="width: 0%;"></div>
                        </div>
                        
                        <div class="player-controls">
                            <button class="player-btn player-btn-secondary" id="prev-ayah-btn" onclick="QuranReview.previousWardAyah()">
                                โฎ๏ธ
                            </button>
                            <button class="player-btn player-btn-lg" id="play-ward-btn" onclick="QuranReview.toggleWardPlay()">
                                โถ๏ธ
                            </button>
                            <button class="player-btn player-btn-secondary" id="next-ayah-btn" onclick="QuranReview.nextWardAyah()">
                                โญ๏ธ
                            </button>
                        </div>
                        
                        <div class="d-flex" style="justify-content: center; margin-top: var(--space-4);">
                            <button class="btn btn-outline btn-sm" id="stop-ward-btn" onclick="AudioManager.stopAll()">
                                โน๏ธ ุฅููุงู
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- PROGRESS PAGE -->
        <div id="progress-page" class="page">
            <section class="section">
                <div class="container">
                    <h2 class="section-title" style="text-align: center; margin-bottom: var(--space-8);">๐ ุชูุฏูู ูู ุงูุญูุธ</h2>
                    
                    <div class="grid grid-cols-4" style="margin-bottom: var(--space-8);">
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="progress-total-surahs">0</div>
                            <p style="color: var(--color-text-secondary); margin-top: var(--space-2);">ุณูุฑุฉ ูุญููุธุฉ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="progress-total-ayahs">0</div>
                            <p style="color: var(--color-text-secondary); margin-top: var(--space-2);">ุขูุฉ ูุญููุธุฉ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="progress-completion">0%</div>
                            <p style="color: var(--color-text-secondary); margin-top: var(--space-2);">ูุณุจุฉ ุงูุฅูุฌุงุฒ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="progress-streak">0</div>
                            <p style="color: var(--color-text-secondary); margin-top: var(--space-2);">ููู ูุชุชุงูู</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2" style="margin-bottom: var(--space-8);">
                        <div class="glass-card">
                            <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐ ุชูุฒูุน ุงูุญุงูุงุช</h3>
                            <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                                <div class="d-flex" style="justify-content: space-between;">
                                    <span class="d-flex" style="gap: var(--space-2);"><span class="status-badge status-strong"></span><span>ูุชูู</span></span>
                                    <span id="status-strong-count" style="font-weight: 600;">0</span>
                                </div>
                                <div class="d-flex" style="justify-content: space-between;">
                                    <span class="d-flex" style="gap: var(--space-2);"><span class="status-badge status-weak"></span><span>ุถุนูู</span></span>
                                    <span id="status-weak-count" style="font-weight: 600;">0</span>
                                </div>
                                <div class="d-flex" style="justify-content: space-between;">
                                    <span class="d-flex" style="gap: var(--space-2);"><span class="status-badge status-new"></span><span>ุฌุฏูุฏ</span></span>
                                    <span id="status-new-count" style="font-weight: 600;">0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="glass-card">
                            <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐ ูุดุงุท ุงูุฃุณุจูุน</h3>
                            <div class="grid grid-cols-7" style="text-align: center; gap: var(--space-2);">
                                <div class="glass-card" style="padding: var(--space-3);"><div style="font-size: 0.75rem; color: var(--color-text-secondary);">ุณุจุช</div><div style="font-weight: 600;" id="activity-sat">0</div></div>
                                <div class="glass-card" style="padding: var(--space-3);"><div style="font-size: 0.75rem; color: var(--color-text-secondary);">ุฃุญุฏ</div><div style="font-weight: 600;" id="activity-sun">0</div></div>
                                <div class="glass-card" style="padding: var(--space-3);"><div style="font-size: 0.75rem; color: var(--color-text-secondary);">ุงุซู</div><div style="font-weight: 600;" id="activity-mon">0</div></div>
                                <div class="glass-card" style="padding: var(--space-3);"><div style="font-size: 0.75rem; color: var(--color-text-secondary);">ุซูุง</div><div style="font-weight: 600;" id="activity-tue">0</div></div>
                                <div class="glass-card" style="padding: var(--space-3);"><div style="font-size: 0.75rem; color: var(--color-text-secondary);">ุฃุฑุจ</div><div style="font-weight: 600;" id="activity-wed">0</div></div>
                                <div class="glass-card" style="padding: var(--space-3);"><div style="font-size: 0.75rem; color: var(--color-text-secondary);">ุฎูู</div><div style="font-weight: 600;" id="activity-thu">0</div></div>
                                <div class="glass-card" style="padding: var(--space-3);"><div style="font-size: 0.75rem; color: var(--color-text-secondary);">ุฌูุนุฉ</div><div style="font-weight: 600;" id="activity-fri">0</div></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-card">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐ ุชุทูุฑ ุงูุญูุธ</h3>
                        <div style="height: 300px; background: rgba(45, 80, 22, 0.05); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; color: var(--color-text-secondary);">
                            <div style="text-align: center;"><div style="font-size: 3rem; margin-bottom: var(--space-4);">๐</div><p>ุงูุฑุณู ุงูุจูุงูู ูุฑูุจุงู</p></div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- COMPETITION PAGE -->
        <div id="competition-page" class="page">
            <section class="section" style="min-height: 80vh;">
                <div class="container">
                    <h2 class="section-title" style="text-align: center; margin-bottom: var(--space-8);">๐ ุงูุชุญุฏูุงุช</h2>
                    
                    <!-- Competition Dashboard Container -->
                    <div id="competition-dashboard" style="display: block;">
                    <div class="card" style="margin-bottom: var(--space-8);">
                        <div class="" style="text-align: center; padding: var(--space-8);">
                            <div style="font-size: 5rem; margin-bottom: var(--space-4);">๐ฅ</div>
                            <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: var(--space-2);">ุฑุชุจุชู: <span id="user-rank">ุฐูุจู</span></h3>
                            <p style="color: var(--color-text-secondary); margin-bottom: var(--space-4);">ูุฏูู <span id="user-points" style="font-weight: 600; color: var(--color-primary);">1,250</span> ููุทุฉ</p>
                            
                            <!-- Stats Grid for Competition -->
                            <div class="grid grid-cols-3" style="max-width: 400px; margin: 0 auto var(--space-4);">
                                <div class="glass-card" style="padding: var(--space-3);">
                                    <div style="font-size: 1.25rem; font-weight: 700;" id="comp-wins">0</div>
                                    <div style="font-size: 0.75rem; color: var(--color-text-secondary);">ุงูุชุตุงุฑุงุช</div>
                                </div>
                                <div class="glass-card" style="padding: var(--space-3);">
                                    <div style="font-size: 1.25rem; font-weight: 700;" id="comp-streak">๐ฅ 0</div>
                                    <div style="font-size: 0.75rem; color: var(--color-text-secondary);">ูุชุชุงููุฉ</div>
                                </div>
                                <div class="glass-card" style="padding: var(--space-3);">
                                    <div style="font-size: 1.25rem; font-weight: 700;" id="comp-challenges">0</div>
                                    <div style="font-size: 0.75rem; color: var(--color-text-secondary);">ุชุญุฏูุงุช</div>
                                </div>
                            </div>
                            
                            <div class="progress-glass" style="max-width: 400px; margin: 0 auto;"><div class="fill" style="width: 65%;"></div></div>
                            <p style="font-size: 0.875rem; color: var(--color-text-secondary); margin-top: var(--space-2);">750 ููุทุฉ ูููุตูู ุฅูู ุงูุจูุงุชููููู</p>
                        </div>
                    </div>
                    
                    <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: var(--space-6);">๐ฎ ุงุฎุชุฑ ุชุญุฏูุงู</h3>
                    <div class="grid grid-cols-3" style="margin-bottom: var(--space-8);">
                        <div class="glass-card hover-lift" style="text-align: center;">
                            <div style="font-size: 3rem; margin-bottom: var(--space-4);">โก</div>
                            <h4 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-2);">ุงูุณุจุงู</h4>
                            <p style="color: var(--color-text-secondary); font-size: 0.875rem; margin-bottom: var(--space-4);">5 ุขูุงุช ูู 5 ุฏูุงุฆู</p>
                            <button class="btn btn-primary" onclick="QuranReview.startChallenge('speed_run')">ุงุจุฏุฃ</button>
                        </div>
                        <div class="glass-card hover-lift" style="text-align: center;">
                            <div style="font-size: 3rem; margin-bottom: var(--space-4);">๐</div>
                            <h4 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-2);">ุตูุฏ ุงูุขูุฉ</h4>
                            <p style="color: var(--color-text-secondary); font-size: 0.875rem; margin-bottom: var(--space-4);">ุญุฏุฏ ุงูุณูุฑุฉ ูู ุงูุขูุฉ</p>
                            <button class="btn btn-primary" onclick="QuranReview.startChallenge('ayah_hunt')">ุงุจุฏุฃ</button>
                        </div>
                        <div class="glass-card hover-lift" style="text-align: center;">
                            <div style="font-size: 3rem; margin-bottom: var(--space-4);">๐ฏ</div>
                            <h4 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-2);">ุณูุฏ ุงูุฏูุฉ</h4>
                            <p style="color: var(--color-text-secondary); font-size: 0.875rem; margin-bottom: var(--space-4);">ุงูุชุจ ุงูุขูุฉ ุจุดูู ุตุญูุญ</p>
                            <button class="btn btn-primary" onclick="QuranReview.startChallenge('precision')">ุงุจุฏุฃ</button>
                        </div>
                    </div>
                    
                    <div class="glass-card">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐ ููุญุฉ ุงููุชุตุฏุฑูู</h3>
                        <div id="leaderboard-list">
                            <div class="memorization-item" style="background: rgba(212, 165, 116, 0.1); border-color: var(--color-gold);">
                                <span style="font-size: 1.5rem; margin-left: var(--space-3);">๐ฅ</span>
                                <div style="flex: 1;"><div style="font-weight: 600;">ุฃุญูุฏ</div><div style="font-size: 0.875rem; color: var(--color-text-secondary);">2,400 ููุทุฉ</div></div>
                                <span class="badge badge-gold">๐ ูุงุณู</span>
                            </div>
                            <div class="memorization-item">
                                <span style="font-size: 1.5rem; margin-left: var(--space-3);">๐ฅ</span>
                                <div style="flex: 1;"><div style="font-weight: 600;">ูุงุทูุฉ</div><div style="font-size: 0.875rem; color: var(--color-text-secondary);">1,800 ููุทุฉ</div></div>
                                <span class="badge badge-primary">๐ ุจูุงุชููููู</span>
                            </div>
                            <div class="memorization-item">
                                <span style="font-size: 1.5rem; margin-left: var(--space-3);">๐ฅ</span>
                                <div style="flex: 1;"><div style="font-weight: 600;">ูุญูุฏ</div><div style="font-size: 0.875rem; color: var(--color-text-secondary);">1,250 ููุทุฉ</div></div>
                                <span class="badge badge-gold">๐ฅ ุฐูุจู</span>
                            </div>
                        </div>
                    </div>
                    </div><!-- /competition-dashboard -->
                    
                    <!-- Competition Active Container (Hidden by default) -->
                    <div id="competition-active" class="hidden" style="display: none;">
                        <div class="glass-card">
                            <div class="d-flex" style="justify-content: space-between; margin-bottom: var(--space-4); flex-wrap: wrap; gap: var(--space-2);">
                                <span class="badge badge-primary" id="comp-score">ุงูููุงุท: 0</span>
                                <span class="badge badge-glass" id="comp-timer">โฑ๏ธ 05:00</span>
                                <span class="badge badge-gold" id="comp-streak">๐ฅ 0</span>
                            </div>
                            <div id="game-area" style="min-height: 300px; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                                <div style="font-size: 4rem; margin-bottom: var(--space-4);">๐ฎ</div>
                                <p style="color: var(--color-text-secondary);">ุงุฎุชุฑ ุชุญุฏูุงู ููุจุฏุก</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- HIFZ PAGE -->
        <div id="hifz-page" class="page">
            <section class="section" style="min-height: 80vh;">
                <div class="container" style="max-width: 900px;">
                    <h2 class="section-title" style="text-align: center; margin-bottom: var(--space-8);">๐ญ ูุถุน ุงูุญูุธ</h2>
                    
                    <!-- Hifz Selection Container -->
                    <div class="glass-card" id="hifz-selection" style="margin-bottom: var(--space-6); display: block;">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">ุงุฎุชูุงุฑ ุงูุชูุฑูู</h3>
                        
                        <form id="hifz-start-form">
                            <div class="form-floating" style="margin-bottom: var(--space-4);">
                                <select id="hifz-surah-select" required>
                                    <option value="">-- ุงุฎุชุฑ ุงูุณูุฑุฉ --</option>
                                </select>
                                <label for="hifz-surah-select">ุงูุณูุฑุฉ</label>
                            </div>
                            
                            <div class="grid grid-cols-2" style="margin-bottom: var(--space-4);">
                                <div class="form-floating">
                                    <input type="number" id="hifz-from-ayah" min="1" value="1" placeholder=" " required>
                                    <label for="hifz-from-ayah">ูู ุงูุขูุฉ</label>
                                </div>
                                <div class="form-floating">
                                    <input type="number" id="hifz-to-ayah" min="1" value="7" placeholder=" " required>
                                    <label for="hifz-to-ayah">ุฅูู ุงูุขูุฉ</label>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-primary btn-full">
                                <span>๐ฎ</span>
                                ุงุจุฏุฃ ุงูุชูุฑูู
                            </button>
                        </form>
                    </div>
                    
                    <!-- Hifz Active Game Container -->
                    <div class="glass-card" id="hifz-active-container" style="display: none;">
                        <div class="d-flex" style="justify-content: space-between; margin-bottom: var(--space-4); flex-wrap: wrap; gap: var(--space-2);">
                            <div>
                                <span class="badge badge-primary" id="hifz-score">ุงูููุงุท: 0</span>
                                <span class="badge badge-glass" id="hints-count" style="margin-right: var(--space-2);">ุชูููุญุงุช: 3</span>
                            </div>
                            <span class="badge badge-gold" id="hifz-level">ุงููุณุชูู: โญโญโญ</span>
                        </div>
                        
                        <!-- Hifz Display Container -->
                        <div id="hifz-display" style="margin: var(--space-6) 0; min-height: 150px; background: rgba(45, 80, 22, 0.03); border-radius: var(--radius-xl); padding: var(--space-4); display: flex; align-items: center; justify-content: center;">
                            <p style="color: var(--color-text-secondary);">ุงุฎุชุฑ ุณูุฑุฉ ูุขูุงุช ููุจุฏุก</p>
                        </div>
                        
                        <!-- Hifz Text (fallback display) -->
                        <div class="arabic-large" id="hifz-text" style="text-align: center; line-height: 2.5; margin: var(--space-6) 0; font-size: 1.75rem; display: none;">
                            ุจูุณููู ุงูููููู ุงูุฑููุญููููฐูู ุงูุฑููุญูููู
                        </div>
                        
                        <!-- Feedback Area -->
                        <div id="hifz-feedback" style="text-align: center; margin: var(--space-4) 0; min-height: 30px;"></div>
                        
                        <div class="d-flex" style="justify-content: center; gap: var(--space-3); flex-wrap: wrap;">
                            <button class="btn btn-outline" onclick="QuranReview.showHint()">
                                <span>๐ก</span>
                                ุชูููุญ
                            </button>
                            <button class="btn btn-primary" onclick="QuranReview.checkMemorization()">
                                <span>โ</span>
                                ุชุญูู
                            </button>
                            <button class="btn btn-outline" onclick="QuranReview.nextLevel()">
                                <span>โญ๏ธ</span>
                                ุงูุชุงูู
                            </button>
                            <button class="btn btn-outline" onclick="QuranReview.stopHifzSession()">
                                <span>โน๏ธ</span>
                                ุฅููุงู
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- SETTINGS PAGE -->
        <div id="settings-page" class="page">
            <section class="section">
                <div class="container" style="max-width: 600px;">
                    <h2 class="section-title" style="text-align: center; margin-bottom: var(--space-8);">โ๏ธ ุงูุฅุนุฏุงุฏุงุช</h2>
                    
                    <div class="glass-card" style="margin-bottom: var(--space-6);">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐ค ุงูููู ุงูุดุฎุตู</h3>
                        <form id="settings-form" onsubmit="QuranReview.saveSettings(event)">
                            <div class="form-floating" style="margin-bottom: var(--space-4);">
                                <input type="text" id="user-name" placeholder=" " value="">
                                <label for="user-name">ุงุณูู</label>
                            </div>
                            
                            <div class="form-floating" style="margin-bottom: var(--space-4);">
                                <input type="number" id="daily-goal" min="1" max="50" value="5" placeholder=" ">
                                <label for="daily-goal">ุงููุฏู ุงููููู (ุขูุงุช)</label>
                            </div>
                            
                            <div style="margin-bottom: var(--space-4);">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notifications" checked>
                                    <span class="toggle-slider"></span>
                                    <span style="margin-right: var(--space-3);">ุงูุฅุดุนุงุฑุงุช</span>
                                </label>
                            </div>
                            
                            <button type="submit" class="btn btn-primary btn-full">ุญูุธ ุงูุชุบููุฑุงุช</button>
                        </form>
                    </div>
                    
                    <div class="glass-card" style="margin-bottom: var(--space-6);">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐จ ุงููุธูุฑ</h3>
                        
                        <div style="margin-bottom: var(--space-4);">
                            <label style="display: block; margin-bottom: var(--space-3); font-weight: 500;">ุงููุถุน</label>
                            <div class="d-flex" style="gap: var(--space-3);">
                                <button type="button" class="btn btn-outline" id="theme-light-btn" onclick="QuranReview.setTheme('light')">โ๏ธ ูุงุชุญ</button>
                                <button type="button" class="btn btn-outline" id="theme-dark-btn" onclick="QuranReview.setTheme('dark')">๐ ุฏุงูู</button>
                            </div>
                        </div>
                        
                        <div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="settings-notifications" checked>
                                <span class="toggle-slider"></span>
                                <span style="margin-right: var(--space-3);">ุงูุฅุดุนุงุฑุงุช</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="glass-card">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐พ ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช</h3>
                        <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                            <button class="btn btn-outline" onclick="QuranReview.exportData()">
                                <span>๐ค</span> ุชุตุฏูุฑ ุงูุจูุงูุงุช
                            </button>
                            <button class="btn btn-outline" onclick="QuranReview.importData()">
                                <span>๐ฅ</span> ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช
                            </button>
                            <button class="btn btn-outline" onclick="QuranReview.resetData()" style="color: var(--color-danger);">
                                <span>๐๏ธ</span> ุฅุนุงุฏุฉ ุชุนููู
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- MY TASKS PAGE -->
        <div id="mytasks-page" class="page">
            <section class="section">
                <div class="container">
                    <h2 class="section-title" style="text-align: center; margin-bottom: var(--space-8);">๐ ููุงูู</h2>
                    <p id="student-welcome" style="text-align: center; color: var(--color-text-secondary); margin-bottom: var(--space-2);"></p>
                    <p id="student-teacher-info" style="text-align: center; color: var(--color-text-secondary); margin-bottom: var(--space-6); font-size: 0.9rem;"></p>
                    
                    <!-- Student Task Stats -->
                    <div class="grid grid-cols-4" style="margin-bottom: var(--space-6);">
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="student-points">0</div>
                            <p style="color: var(--color-text-secondary);">ุงูููุงุท</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="student-tasks-done">0</div>
                            <p style="color: var(--color-text-secondary);">ููุชููุฉ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="student-tasks-pending">0</div>
                            <p style="color: var(--color-text-secondary);">ููุฏ ุงูุงูุชุธุงุฑ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="student-tasks-rejected">0</div>
                            <p style="color: var(--color-text-secondary);">ูุฑููุถุฉ</p>
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <button class="tab active" onclick="QuranReview.switchTaskTab('pending')">ููุฏ ุงูุงูุชุธุงุฑ</button>
                        <button class="tab" onclick="QuranReview.switchTaskTab('completed')">ููุชููุฉ</button>
                    </div>
                    
                    <div id="student-tasks-list" class="glass-card">
                        <div class="task-card">
                            <span class="task-status task-status-pending"></span>
                            <div style="flex: 1;">
                                <div style="font-weight: 600;">ุญูุธ ุณูุฑุฉ ุงููุงุชุญุฉ</div>
                                <div style="font-size: 0.875rem; color: var(--color-text-secondary);">ูุนูู: ุฃุญูุฏ โข ุชุณููู: ุบุฏุงู</div>
                            </div>
                            <span class="badge badge-primary">10 ููุงุท</span>
                        </div>
                    </div>

                    <div class="glass-card" style="margin-top: var(--space-6);">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐ ุณุฌู ุงูููุงุท</h3>
                        <div id="student-points-log"></div>
                    </div>

                    <div class="glass-card" style="margin-top: var(--space-6);">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐ค ุชุณูููุงุชู</h3>
                        <div id="student-submissions-list"></div>
                    </div>
                </div>
            </section>
        </div>

        <!-- TEACHER PAGE -->
        <div id="teacher-page" class="page">
            <section class="section">
                <div class="container">
                    <h2 class="section-title" style="text-align: center; margin-bottom: var(--space-8);">๐ ููุญุฉ ุงููุนูู</h2>
                    
                    <div class="grid grid-cols-4" style="margin-bottom: var(--space-8);">
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="teacher-total-students">0</div>
                            <p style="color: var(--color-text-secondary);">ุนุฏุฏ ุงูุทูุงุจ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="teacher-pending">0</div>
                            <p style="color: var(--color-text-secondary);">ุชุณูููุงุช ูุนููุฉ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="teacher-tasks">0</div>
                            <p style="color: var(--color-text-secondary);">ุงูููุงู</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="teacher-approved">0</div>
                            <p style="color: var(--color-text-secondary);">ููุจููุฉ</p>
                        </div>
                    </div>
                    
                    <div class="glass-card" style="margin-bottom: var(--space-6);">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">โ ุฅูุดุงุก ูููุฉ ุฌุฏูุฏุฉ</h3>
                        <form id="teacher-create-task-form" onsubmit="QuranReview.createTask(event)">
                            <div class="form-floating" style="margin-bottom: var(--space-4);">
                                <input type="text" id="task-title" placeholder=" " required>
                                <label for="task-title">ุนููุงู ุงููููุฉ</label>
                            </div>
                            <div class="form-floating" style="margin-bottom: var(--space-4);">
                                <textarea id="task-description" placeholder=" " style="min-height: 80px; resize: vertical;"></textarea>
                                <label for="task-description">ูุตู ุงููููุฉ</label>
                            </div>
                            <div class="grid grid-cols-2" style="margin-bottom: var(--space-4);">
                                <div class="form-floating">
                                    <select id="task-type">
                                        <option value="memorization">ุญูุธ</option>
                                        <option value="review">ูุฑุงุฌุนุฉ</option>
                                        <option value="tajweed">ุชุฌููุฏ</option>
                                    </select>
                                    <label for="task-type">ููุน ุงููููุฉ</label>
                                </div>
                                <div class="form-floating">
                                    <input type="number" id="task-points" min="0" value="10" placeholder=" ">
                                    <label for="task-points">ุงูููุงุท</label>
                                </div>
                            </div>
                            <div class="form-floating" style="margin-bottom: var(--space-4);">
                                <input type="date" id="task-due-date" placeholder=" ">
                                <label for="task-due-date">ุชุงุฑูุฎ ุงูุชุณููู</label>
                            </div>
                            <button type="submit" class="btn btn-primary btn-full">ุฅูุดุงุก ุงููููุฉ</button>
                        </form>
                    </div>
                    
                    <div class="glass-card" style="margin-bottom: var(--space-6);">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐ฅ ูุงุฆูุฉ ุงูุทูุงุจ</h3>
                        <div id="teacher-students-list">
                            <p class="empty-state">ุฌุงุฑู ุงูุชุญููู...</p>
                        </div>
                    </div>

                    <div class="glass-card" style="margin-bottom: var(--space-6);">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐ฅ ุชุณูููุงุช ูุนููุฉ</h3>
                        <div id="teacher-pending-list">
                            <p class="empty-state">ุฌุงุฑู ุงูุชุญููู...</p>
                        </div>
                    </div>

                    <div class="glass-card">
                        <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: var(--space-4);">๐ ูุงุฆูุฉ ุงูููุงู</h3>
                        <div id="teacher-tasks-list">
                            <p class="empty-state">ุฌุงุฑู ุงูุชุญููู...</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ADMIN PAGE -->
        <div id="admin-page" class="page">
            <section class="section">
                <div class="container">
                    <h2 class="section-title" style="text-align: center; margin-bottom: var(--space-8);">โ๏ธ ููุญุฉ ุงูุฅุฏุงุฑุฉ</h2>
                    <div class="grid grid-cols-4" style="margin-bottom: var(--space-8);">
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="admin-total-users">0</div>
                            <p style="color: var(--color-text-secondary);">ุฅุฌูุงูู ุงููุณุชุฎุฏููู</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="admin-total-students">0</div>
                            <p style="color: var(--color-text-secondary);">ุงูุทูุงุจ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="admin-total-teachers">0</div>
                            <p style="color: var(--color-text-secondary);">ุงูุฃุณุงุชุฐุฉ</p>
                        </div>
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-value" id="admin-total-admins">0</div>
                            <p style="color: var(--color-text-secondary);">ุงููุฏูุฑูู</p>
                        </div>
                    </div>
                    <div class="glass-card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-4);">
                            <h3 style="font-size: 1.125rem; font-weight: 600;">๐ฅ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</h3>
                            <button class="btn btn-primary btn-sm" onclick="QuranReview.refreshAdminUsers()">๐ ุชุญุฏูุซ</button>
                        </div>
                        <div id="admin-users-list">
                            <p style="color: var(--color-text-secondary); text-align: center; padding: var(--space-6);">ุฌุงุฑู ุงูุชุญููู...</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- User Edit Modal (Admin) -->
    <div class="modal-overlay hidden" id="user-edit-modal">
        <div class="modal-content" style="max-width: 420px;">
            <div style="text-align: center; margin-bottom: var(--space-6);">
                <div style="font-size: 3rem; margin-bottom: var(--space-2);">โ๏ธ</div>
                <h2 style="font-size: 1.5rem; font-weight: 700;">ุชุนุฏูู ุงููุณุชุฎุฏู</h2>
            </div>
            
            <div id="user-edit-error" class="hidden" style="background: rgba(239, 68, 68, 0.1); color: var(--color-danger); padding: var(--space-3); border-radius: var(--radius-lg); margin-bottom: var(--space-4); text-align: center;"></div>
            <div id="user-edit-success" class="hidden" style="background: rgba(34, 197, 94, 0.1); color: var(--color-success); padding: var(--space-3); border-radius: var(--radius-lg); margin-bottom: var(--space-4); text-align: center;">ุชู ุงูุญูุธ ุจูุฌุงุญ</div>
            
            <form id="user-edit-form" onsubmit="QuranReview.handleUpdateUser(event)">
                <input type="hidden" id="edit-user-id">
                
                <div class="form-floating" style="margin-bottom: var(--space-4);">
                    <input type="text" id="edit-username" placeholder=" " disabled>
                    <label for="edit-username">ุงุณู ุงููุณุชุฎุฏู</label>
                </div>
                
                <div class="form-floating" style="margin-bottom: var(--space-4);">
                    <input type="text" id="edit-first-name" placeholder=" ">
                    <label for="edit-first-name">ุงูุงุณู ุงูุฃูู</label>
                </div>
                
                <div class="form-floating" style="margin-bottom: var(--space-4);">
                    <input type="text" id="edit-last-name" placeholder=" ">
                    <label for="edit-last-name">ุงุณู ุงูุนุงุฆูุฉ</label>
                </div>
                
                <div class="form-floating" style="margin-bottom: var(--space-4);">
                    <select id="edit-role">
                        <option value="student">ุทุงูุจ</option>
                        <option value="teacher">ูุนูู</option>
                        <option value="admin">ูุฏูุฑ</option>
                    </select>
                    <label for="edit-role">ุงูุฏูุฑ</label>
                </div>
                
                <div style="margin-bottom: var(--space-6);">
                    <label class="toggle-switch">
                        <input type="checkbox" id="edit-is-superuser">
                        <span class="toggle-slider"></span>
                        <span style="margin-right: var(--space-3);">ูุฏูุฑ ูุธุงู (Superuser)</span>
                    </label>
                </div>
                
                <div class="d-flex" style="gap: var(--space-3);">
                    <button type="button" class="btn btn-outline" style="flex: 1;" onclick="QuranReview.closeUserEditModal()">ุฅูุบุงุก</button>
                    <button type="submit" class="btn btn-primary" style="flex: 1;">ุญูุธ ุงูุชุบููุฑุงุช</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal-overlay hidden" id="auth-modal">
        <div class="modal-content" style="max-width: 420px;">
            <!-- Login Form -->
            <div id="auth-login-form" class="active">
                <div style="text-align: center; margin-bottom: var(--space-6);">
                    <div style="font-size: 3rem; margin-bottom: var(--space-2);">๐</div>
                    <h2 style="font-size: 1.5rem; font-weight: 700;">ุชุณุฌูู ุงูุฏุฎูู</h2>
                    <p style="color: var(--color-text-secondary);">ุฃููุงู ุจู ูุฌุฏุฏุงู ูู ูุฑุงุฌุนุฉ ุงููุฑุขู</p>
                </div>
                
                <form id="login-form">
                    <div id="login-error" class="hidden" style="background: rgba(239, 68, 68, 0.1); color: var(--color-danger); padding: var(--space-3); border-radius: var(--radius-lg); margin-bottom: var(--space-4); text-align: center;"></div>
                    
                    <div class="form-floating" style="margin-bottom: var(--space-4);">
                        <input type="text" id="login-username" placeholder=" " autocomplete="username" required>
                        <label for="login-username">ุงุณู ุงููุณุชุฎุฏู</label>
                    </div>
                    
                    <div class="form-floating" style="margin-bottom: var(--space-6);">
                        <input type="password" id="login-password" placeholder=" " autocomplete="current-password" required>
                        <label for="login-password">ูููุฉ ุงููุฑูุฑ</label>
                    </div>
                    
                    <button type="button" class="btn btn-primary btn-full" id="login-submit-btn" onclick="QuranReview.handleLogin(event)">
                        <span>๐</span>
                        ุฏุฎูู
                    </button>
                </form>
                
                <p style="text-align: center; margin-top: var(--space-6); padding-top: var(--space-4); border-top: 1px solid var(--color-border);">
                    <span style="color: var(--color-text-secondary);">ููุณ ูุฏูู ุญุณุงุจุ </span>
                    <a href="#" onclick="QuranReview.showRegisterForm(event)" style="color: var(--color-primary); font-weight: 600;">ุณุฌู ุงูุขู</a>
                </p>
            </div>
            
            <!-- Register Form -->
            <div id="auth-register-form" class="hidden">
                <div style="text-align: center; margin-bottom: var(--space-6);">
                    <div style="font-size: 3rem; margin-bottom: var(--space-2);">๐</div>
                    <h2 style="font-size: 1.5rem; font-weight: 700;">ุฅูุดุงุก ุญุณุงุจ</h2>
                    <p style="color: var(--color-text-secondary);">ุงุจุฏุฃ ุฑุญูุชู ูู ุญูุธ ุงููุฑุขู</p>
                </div>
                
                <form id="register-form">
                    <div id="reg-error" class="hidden" style="background: rgba(239, 68, 68, 0.1); color: var(--color-danger); padding: var(--space-3); border-radius: var(--radius-lg); margin-bottom: var(--space-4); text-align: center;"></div>
                    
                    <div class="form-floating" style="margin-bottom: var(--space-4);">
                        <input type="text" id="reg-username" placeholder=" " autocomplete="username" required>
                        <label for="reg-username">ุงุณู ุงููุณุชุฎุฏู</label>
                    </div>
                    
                    <div class="form-floating" style="margin-bottom: var(--space-4);">
                        <input type="text" id="reg-first-name" placeholder=" ">
                        <label for="reg-first-name">ุงูุงุณู ุงูุฃูู</label>
                    </div>
                    
                    <div class="form-floating" style="margin-bottom: var(--space-4);">
                        <input type="text" id="reg-last-name" placeholder=" ">
                        <label for="reg-last-name">ุงุณู ุงูุนุงุฆูุฉ</label>
                    </div>
                    
                    <div class="form-floating" style="margin-bottom: var(--space-6);">
                        <input type="password" id="reg-password" placeholder=" " autocomplete="new-password" required>
                        <label for="reg-password">ูููุฉ ุงููุฑูุฑ</label>
                    </div>
                    
                    <button type="button" class="btn btn-primary btn-full" id="reg-submit-btn" onclick="QuranReview.handleRegister(event)">
                        <span>โจ</span>
                        ุฅูุดุงุก ุงูุญุณุงุจ
                    </button>
                </form>
                
                <p style="text-align: center; margin-top: var(--space-6); padding-top: var(--space-4); border-top: 1px solid var(--color-border);">
                    <span style="color: var(--color-text-secondary);">ูุฏูู ุญุณุงุจ ุจุงููุนูุ </span>
                    <a href="#" onclick="QuranReview.showLoginForm(event)" style="color: var(--color-primary); font-weight: 600;">ุชุณุฌูู ุงูุฏุฎูู</a>
                </p>
            </div>
        </div>
    </div>

    <script>
        // Register GSAP ScrollTrigger
        gsap.registerPlugin(ScrollTrigger);
        
        // Loading Screen
        function hideLoadingScreen() {
            const loadingScreen = document.getElementById('loading-screen');
            if (!loadingScreen) return;
            
            gsap.to(loadingScreen, {
                opacity: 0,
                duration: 0.4,
                onComplete: () => {
                    loadingScreen.classList.add('hidden');
                    loadingScreen.style.display = 'none';
                    initAnimations();
                }
            });
        }
        
        window.addEventListener('load', () => {
            const loadingScreen = document.getElementById('loading-screen');
            
            // Animate progress bar
            gsap.to('#loading-progress', {
                width: '100%',
                duration: 1.0,
                ease: 'power2.inOut',
                onComplete: () => {
                    // Small delay then hide
                    setTimeout(hideLoadingScreen, 300);
                }
            });
        });
        
        // Fallback: hide loading screen after 5 seconds max
        setTimeout(() => {
            const loadingScreen = document.getElementById('loading-screen');
            if (loadingScreen && !loadingScreen.classList.contains('hidden')) {
                console.warn('Loading screen timeout - forcing hide');
                hideLoadingScreen();
            }
        }, 5000);
        
        // Show demo badge if in file:// mode
        if (window.location.protocol === 'file:') {
            const demoBadge = document.getElementById('demo-badge');
            if (demoBadge) demoBadge.classList.remove('hidden');
            console.log('๐ฎ Mode DรMO dรฉtectรฉ - Badge affichรฉ');
        }
        
        // Initialize Animations
        function initAnimations() {
            // Stagger animations for cards
            gsap.from('.glass-card', {
                opacity: 0,
                y: 50,
                duration: 0.8,
                stagger: 0.1,
                ease: 'power3.out'
            });
            
            // Stats counter animation
            animateCounters();
            
            // Scroll reveal
            gsap.utils.toArray('.reveal').forEach(element => {
                gsap.from(element, {
                    scrollTrigger: {
                        trigger: element,
                        start: 'top 85%',
                        toggleActions: 'play none none reverse'
                    },
                    opacity: 0,
                    y: 30,
                    duration: 0.8,
                    ease: 'power2.out'
                });
            });
        }
        
        // Counter Animation
        function animateCounters() {
            document.querySelectorAll('[data-count]').forEach(counter => {
                const target = parseInt(counter.getAttribute('data-count'));
                gsap.to(counter, {
                    innerHTML: target,
                    duration: 2,
                    snap: { innerHTML: 1 },
                    ease: 'power2.out',
                    scrollTrigger: {
                        trigger: counter,
                        start: 'top 80%'
                    }
                });
            });
        }
        
        // Generate Particles
        const particlesContainer = document.getElementById('particles');
        for (let i = 0; i < 30; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 20 + 's';
            particle.style.animationDuration = (15 + Math.random() * 10) + 's';
            particle.style.width = (3 + Math.random() * 6) + 'px';
            particle.style.height = particle.style.width;
            particlesContainer.appendChild(particle);
        }
        
        // Navigation
        function navigateTo(page) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            // Show target page
            document.getElementById(page + '-page').classList.add('active');
            
            // Update nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === page) {
                    link.classList.add('active');
                }
            });
            
            // Animate new page
            gsap.from('#' + page + '-page', {
                opacity: 0,
                y: 20,
                duration: 0.5,
                ease: 'power2.out'
            });
            
            window.scrollTo(0, 0);
        }
        
        // Nav link click handlers
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const page = link.getAttribute('data-page');
                navigateTo(page);
            });
        });
        
        // Theme Toggle
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');
        let isDark = false;
        
        themeToggle.addEventListener('click', () => {
            isDark = !isDark;
            document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
            themeIcon.textContent = isDark ? 'โ๏ธ' : '๐';
        });
        
        // Auth Modal Functions (Fallback if QuranReview not loaded)
        window.showAuthModal = function() {
            if (window.QuranReview && QuranReview.showAuthModal) {
                QuranReview.showAuthModal();
            } else {
                document.getElementById('auth-modal').classList.add('active');
                // Show login form by default
                document.getElementById('auth-login-form').classList.remove('hidden');
                document.getElementById('auth-register-form').classList.add('hidden');
            }
        };
        
        window.hideAuthModal = function() {
            if (window.QuranReview && QuranReview.hideAuthModal) {
                QuranReview.hideAuthModal();
            } else {
                document.getElementById('auth-modal').classList.remove('active');
            }
        };
        
        document.getElementById('auth-modal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) hideAuthModal();
        });
        
        // Show/Hide Register Form
        window.showRegisterForm = function(e) {
            if (e) e.preventDefault();
            if (window.QuranReview && QuranReview.showRegisterForm) {
                QuranReview.showRegisterForm();
            } else {
                document.getElementById('auth-login-form').classList.add('hidden');
                document.getElementById('auth-register-form').classList.remove('hidden');
            }
        };
        
        window.showLoginForm = function(e) {
            if (e) e.preventDefault();
            if (window.QuranReview && QuranReview.showLoginForm) {
                QuranReview.showLoginForm();
            } else {
                document.getElementById('auth-register-form').classList.add('hidden');
                document.getElementById('auth-login-form').classList.remove('hidden');
            }
        };
        
        // Audio Player Functions
        let isPlaying = false;
        
        function togglePlay() {
            isPlaying = !isPlaying;
            document.getElementById('play-btn').textContent = isPlaying ? 'โธ๏ธ' : 'โถ๏ธ';
        }
        
        function previousAyah() {
            gsap.from('#current-ayah', {
                opacity: 0,
                x: 50,
                duration: 0.3,
                ease: 'power2.out'
            });
        }
        
        function nextAyah() {
            gsap.from('#current-ayah', {
                opacity: 0,
                x: -50,
                duration: 0.3,
                ease: 'power2.out'
            });
        }
        
        // Navigation with fallback
        window.navigateTo = function(page) {
            if (window.QuranReview && QuranReview.navigateTo) {
                QuranReview.navigateTo(page);
            } else {
                // Manual page switching
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                const targetPage = document.getElementById(page + '-page') || document.getElementById('page-' + page);
                if (targetPage) {
                    targetPage.classList.add('active');
                    window.scrollTo(0, 0);
                }
                
                // Update nav links
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('data-page') === page) {
                        link.classList.add('active');
                    }
                });
            }
        };
        
        // Ripple Effect
        document.querySelectorAll('.btn-ripple').forEach(button => {
            button.addEventListener('click', function(e) {
                const ripple = document.createElement('span');
                ripple.className = 'ripple';
                
                const rect = this.getBoundingClientRect();
                const size = Math.max(rect.width, rect.height);
                
                ripple.style.width = ripple.style.height = size + 'px';
                ripple.style.left = (e.clientX - rect.left - size / 2) + 'px';
                ripple.style.top = (e.clientY - rect.top - size / 2) + 'px';
                
                this.appendChild(ripple);
                
                setTimeout(() => ripple.remove(), 600);
            });
        });
        
        // Service Worker
        if ('serviceWorker' in navigator && location.hostname !== 'localhost' && location.hostname !== '127.0.0.1') {
            navigator.serviceWorker.register('/sw.js')
                .catch(err => console.log('SW registration failed'));
        }
    </script>
    
    <!-- Audio Configuration -->
    <script src="audio-config.js"></script>
    
    <!-- Main Application Script -->
    <script src="script.js"></script>

    <!-- Alias patch: mรฉthodes appelรฉes depuis les onclick du HTML -->
    <script>
        // hifzManager โ les mรฉthodes hifz vivent dans competitionManager
        QuranReview.hifzManager = QuranReview.competitionManager;

        // Mรฉmorisation : afficher/masquer le formulaire d'ajout
        QuranReview.showAddMemorization = function() {
            const el = document.getElementById('add-memorization-form-container');
            if (el) el.style.display = 'block';
        };
        QuranReview.hideAddMemorization = function() {
            const el = document.getElementById('add-memorization-form-container');
            if (el) { el.style.display = 'none'; }
            const form = document.getElementById('add-memorization-form');
            if (form) form.reset();
        };
        QuranReview.handleAddMemorization = function(event) {
            if (event) event.preventDefault();
            QuranReview.addNewMemorization();
            QuranReview.hideAddMemorization();
        };

        // Ward player : boutons de navigation et toggle play/pause
        QuranReview.nextWardAyah     = function() { QuranReview.playNextWardAyah(); };
        QuranReview.previousWardAyah = function() { QuranReview.playPreviousAyah(); };
        QuranReview.toggleWardPlay   = function() {
            if (QuranReview.state.wardPlayer && QuranReview.state.wardPlayer.isPlaying) {
                QuranReview.stopWardPlayback();
            } else {
                QuranReview.playWard();
            }
        };

        console.log('[PATCH] Alias methods injected:', typeof QuranReview.showAddMemorization);
    </script>
    
    <!-- Pro Features & Fixes -->
    <script>
        // Update today's date
        document.addEventListener('DOMContentLoaded', () => {
            const todayElement = document.getElementById('today-date');
            if (todayElement) {
                const today = new Date();
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                todayElement.textContent = today.toLocaleDateString('ar-SA', options);
            }
            
            // Global navigation helper (if QuranReview exists)
            window.navigateTo = function(page) {
                if (window.QuranReview && QuranReview.navigateTo) {
                    QuranReview.navigateTo(page);
                } else {
                    // Fallback: manual page switching
                    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                    const targetPage = document.getElementById(page + '-page');
                    if (targetPage) {
                        targetPage.classList.add('active');
                        window.scrollTo(0, 0);
                    }
                    
                    // Update nav links
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('data-page') === page) {
                            link.classList.add('active');
                        }
                    });
                }
            };
            
            // Fix auth modal functions
            window.showAuthModal = function() {
                if (window.QuranReview && QuranReview.showAuthModal) {
                    QuranReview.showAuthModal();
                } else {
                    document.getElementById('auth-modal').classList.add('active');
                }
            };
            
            window.hideAuthModal = function() {
                if (window.QuranReview && QuranReview.hideAuthModal) {
                    QuranReview.hideAuthModal();
                } else {
                    document.getElementById('auth-modal').classList.remove('active');
                }
            };
            
            // Handle login button click
            const loginBtn = document.getElementById('login-submit-btn');
            if (loginBtn) {
                loginBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (window.QuranReview && QuranReview.handleLogin) {
                        // Let QuranReview handle it
                        return;
                    }
                    // Fallback animation
                    this.classList.add('btn-loading');
                    setTimeout(() => {
                        this.classList.remove('btn-loading');
                        hideAuthModal();
                    }, 1500);
                });
            }
            
            // Define fallback functions for buttons
            window.showAddSurahModal = function() {
                if (window.QuranReview && QuranReview.showAddMemorization) {
                    QuranReview.showAddMemorization();
                } else {
                    // Show simple alert or form
                    navigateTo('memorization');
                }
            };
            
            window.playWard = function() {
                if (window.QuranReview && QuranReview.playWard) {
                    QuranReview.playWard();
                } else {
                    const playBtn = document.getElementById('play-btn');
                    if (playBtn) {
                        isPlaying = !isPlaying;
                        playBtn.textContent = isPlaying ? 'โธ๏ธ' : 'โถ๏ธ';
                    }
                }
            };
            
            window.handleLogin = function() {
                const btn = document.querySelector('#auth-modal .btn-primary');
                if (btn) {
                    btn.classList.add('btn-loading');
                    setTimeout(() => {
                        btn.classList.remove('btn-loading');
                        hideAuthModal();
                        showToast('ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ', 'success');
                    }, 1500);
                }
            };
        });
    </script>
    
    <!-- Hidden Audio Element -->
    <audio id="audio-element" style="display: none;"></audio>
    
    <!-- Hidden file input for import -->
    <input type="file" id="import-file-input" accept=".json" style="display: none;" onchange="QuranReview.handleImportFile(event)">

    <!-- Scroll reveal via IntersectionObserver (compatible avec .main comme scroller) -->
    <script>
        (function() {
            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(function(entry) {
                    if (!entry.isIntersecting) return;
                    const el = entry.target;
                    el.classList.add('revealed');
                    if (el.classList.contains('stagger-children') && typeof gsap !== 'undefined') {
                        gsap.fromTo(el.children,
                            { opacity: 0, y: 20 },
                            { opacity: 1, y: 0, duration: 0.5, stagger: 0.08, ease: 'power2.out' }
                        );
                    }
                    observer.unobserve(el);
                });
            }, { threshold: 0.1, root: null });

            document.querySelectorAll('.reveal, .stagger-children').forEach(function(el) {
                if (el.classList.contains('stagger-children')) el.classList.add('js-animate');
                observer.observe(el);
            });
        })();
    </script>
</body>
</html>
